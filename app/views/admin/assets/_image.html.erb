<% attached = (controller.action_name == 'attach' or controller.controller_name != 'assets') %>
<%= image_tag asset.public_filename(:square) %>
<div>
  <h4><%= truncate(asset.filename,{:length => 50}) %></h4>
  <%= link_to_function "View Info", "AssetBrowser.openInfo(#{asset.id}, this)" %><br />

<% if for_content or attached %>
  <h4>Insert Image</h4>
  <%= link_to_function "Large", "addAsset(#{asset.id}, 'large' )" %> | <%= link_to_function "Medium ", "addAsset(#{asset.id}, 'medium' )" %> | <%= link_to_function "Small ", "addAsset(#{asset.id}, 'thumb' )" %><br/>
<% end -%>
<br/>
<% if for_content %>
  <%= link_to_function "Attach", "AssetBrowser.addAssetToContentNode(#{asset.to_json}.#{asset.class.name.demodulize.underscore})" %>
<% elsif attached %>
  <%= link_to_function "Detach", "AssetBrowser.removeAssetFromContentNode(#{asset.id})" %>
<% else %>
  <%= link_to_function "Delete", "AssetBrowser.assetAction(#{asset.to_json}.#{asset.class.name.demodulize.underscore})" %>
<% end -%>

</div>
