<% attached = (controller.action_name == 'attach' or controller.controller_name != 'assets') %>
<%= link_to_function truncate(asset.filename,{:length => 50}), "AssetBrowser.openInfo(#{asset.id}, this)" %> - <%= asset.description %>
<div>
<%= link_to_function "View Info", "AssetBrowser.openInfo(#{asset.id}, this)" %><br/>

<% if for_content or attached %>
  <%= link_to_function "Insert", "addAsset(#{asset.id})" %></br>
<% end -%>
<br/>
<% if for_content %>
  <%= link_to_function "Attach", "AssetBrowser.addAssetToContentNode(#{asset.to_json}.#{asset.class.name.demodulize.underscore})" %>
<% elsif attached %>
  <%= link_to_function "Detach", "AssetBrowser.removeAssetFromContentNode(#{asset.id})" %>
<% else %>
  <%= link_to_function "Delete", "AssetBrowser.assetAction(#{asset.to_json}.#{asset.class.name.demodulize.underscore})" %>
<% end -%>
</div>